version: '3.8'

services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile.build
      args:
        - MAIN_DOMAIN=${MAIN_DOMAIN:-example.com}
        - WWW_DOMAIN=${WWW_DOMAIN:-www.example.com}
        - COOKIE_DOMAIN=${COOKIE_DOMAIN:-.example.com}
        - API_DOMAIN=${API_DOMAIN:-api.example.com}
        - API_URL=${API_URL:-//api.example.com/api/}
        - MEDIA_DOMAIN=${MEDIA_DOMAIN:-media.example.com}
        - CDN_DOMAIN=${CDN_DOMAIN:-cdn.example.com}
        - HLS_URL=${HLS_URL:-https://media.example.com/vod/vod}
        - MP4_URL=${MP4_URL:-//cdn.example.com/zsf/}
        - RTMP_URL=${RTMP_URL:-rtmp://media.example.com/vod}
        - IMAGE_OPTIMIZER_URL=${IMAGE_OPTIMIZER_URL:-//cdn.example.com/files/images/image.php}
        - SPEEDTEST_URL=${SPEEDTEST_URL:-//cdn.example.com/files/bwtest.jpg}
        - SUBTITLES_URL=${SUBTITLES_URL:-//beta.example.com/subs/}
        - CHANNEL_URL=${CHANNEL_URL:-//beta.example.com/channel.html}
        - CACHED_INIT_URL=${CACHED_INIT_URL:-//www.example.com/init.json}
        - ANONYMOUS_USERNAME=${ANONYMOUS_USERNAME:-anonymous@example.com}
        - SITE_NAME=${SITE_NAME:-Vifi}
        - DISQUS_SHORTNAME=${DISQUS_SHORTNAME:-vifi}
        - FACEBOOK_APP_ID=${FACEBOOK_APP_ID:-}
        - GOOGLE_ANALYTICS_CODE=${GOOGLE_ANALYTICS_CODE:-UA-XXXXX-1}
        - SENTRY_DSN=${SENTRY_DSN:-}
        - API_KEY=${API_KEY:-}
    ports:
      - "8080:80"
    restart: unless-stopped
    environment:
      - NODE_ENV=production
